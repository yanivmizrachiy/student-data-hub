<!doctype html>
<html lang="he" dir="rtl">
<head>
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#1e3a8a">
  <link rel="icon" sizes="192x192" href="./assets/icons/icon-192.png">
  <link rel="apple-touch-icon" sizes="512x512" href="./assets/icons/icon-512.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>× ×™×”×•×œ ×ª×œ××™×“×™× â€” ×—×˜×™×‘×ª ×‘×™× ×™×™×</title>

  <!-- ×¤×•× ×˜ ×¢×‘×¨×™ × ×§×™ -->
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;600;800&display=swap" rel="stylesheet" />

  <!-- ×¢×™×¦×•×‘ ××•×ª×× -->
  <link rel="stylesheet" href="styles.css" />

  <!-- ×¦×‘×¢ ×œ×“×¤×“×¤× ×™× × ×™×™×“×™× -->
  <meta name="theme-color" content="#0e1f40" />

  <script>
    // Redirect to GitHub Pages if running on localhost
    if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
      location.replace('https://yanivmizrachiy.github.io/student-data-hub/');
    }
  </script>
</head>
<body>
  <div class="bg">
    <div class="blob b1"></div>
    <div class="blob b2"></div>
    <div class="blob b3"></div>
  </div>

  <header class="topbar container">
    <div class="brand">
      <span class="logo">ğŸ“š</span>
      <span class="brand-title">× ×™×”×•×œ ×ª×œ××™×“×™×</span>
    </div>
    <div class="admin">
      <small class="muted" style="font-size:1.1rem;font-weight:700;">×”××ª×¨ ×× ×•×”×œ ×¢"×™ ×™× ×™×‘ ×¨×–</small>
    </div>
  </header>

  <main class="hero container">
    <h1 class="hero-title" style="margin-bottom:18px;">× ×™×”×•×œ ×ª×œ××™×“×™×</h1>
    <p class="hero-subtitle" style="font-size:1.1em;color:#b9c1e6;margin-bottom:32px;">×”××ª×¨ ×× ×•×”×œ ×¢"×™ ×™× ×™×‘ ×¨×–</p>
    <section class="grid">
      <a class="grade-card" style="min-height:220px;" href="pages/grade7.html" aria-label="×©×›×‘×ª ×–'">
        <div class="badge">×–×³</div>
        <h2 style="font-size:2.2rem;">×©×›×‘×ª ×–×³</h2>
        <div class="cta" style="background:linear-gradient(90deg,#4ea1ff,#2679ff);font-size:1.2rem;">×›× ×™×¡×”</div>
      </a>
      <a class="grade-card" style="min-height:220px;" href="pages/grade8.html" aria-label="×©×›×‘×ª ×—'">
        <div class="badge green">×—×³</div>
        <h2 style="font-size:2.2rem;">×©×›×‘×ª ×—×³</h2>
        <div class="cta" style="background:linear-gradient(90deg,#43e97b,#ffd200);font-size:1.2rem;">×›× ×™×¡×”</div>
      </a>
      <a class="grade-card" style="min-height:220px;" href="pages/grade9.html" aria-label="×©×›×‘×ª ×˜'">
        <div class="badge orange">×˜×³</div>
        <h2 style="font-size:2.2rem;">×©×›×‘×ª ×˜×³</h2>
        <div class="cta" style="background:linear-gradient(90deg,#ffd200,#ff4e50);font-size:1.2rem;">×›× ×™×¡×”</div>
      </a>
    </section>
    <div id="install-block" class="install">
      <button id="installBtn" class="btn install-btn" aria-label="×”×ª×§×Ÿ ×‘××—×©×‘">×”×ª×§×Ÿ ×‘××—×©×‘</button>
      <p id="iosHint" class="ios-hint" hidden>×‘-iPhone/iPad: ×¤×ª×— ×‘-Safari â†’ ×©×ª×£ â†’ ×”×•×¡×£ ×œ××¡×š ×”×‘×™×ª</p>
    </div>
  </main>


    <!-- ×¡×™×›×•× ×›×•×œ×œ ×™×•×§×¨×ª×™ -->
    <footer class="footer container">
      <div class="summary">
        <span class="sum-label">×¡×”"×› ×ª×œ××™×“×™× ×‘×—×˜×™×‘×ª ×”×‘×™× ×™×™×:</span>
        <span id="totalCount" class="sum-number">â€”</span>
      </div>
      <nav class="small-links">
        <a href="admin.html" class="muted">××¡×š × ×™×”×•×œ (×œ×× ×”×œ×™×)</a>
        <span class="dots">Â·</span>
        <a href="about.html" class="muted">××•×“×•×ª</a>
      </nav>
    </footer>

  <!-- ××•×“××œ ××™××•×ª ×× ×”×œ -->
  <dialog id="adminDialog" class="dialog">
    <form method="dialog" class="dialog-card" id="adminForm">
      <h3>×›× ×™×¡×ª ×× ×”×œ</h3>
      <p class="muted">×”×–×Ÿ ×§×•×“ ×× ×”×œ ×›×“×™ ×œ×¢×¨×•×š × ×ª×•× ×™×.</p>
      <label class="field">
        <span>×§×•×“ ×× ×”×œ</span>
        <input id="adminCode" type="password" inputmode="numeric" autocomplete="off" placeholder="******" required />
      </label>
      <div class="dialog-actions">
        <button value="cancel" class="btn btn-ghost" type="button" id="cancelAdmin">×‘×˜×œ</button>
        <button class="btn" type="submit">××©×¨</button>
      </div>
      <p id="adminError" class="error" role="alert" hidden>×§×•×“ ×©×’×•×™</p>
    </form>
  </dialog>

  <p id="last-updated" dir="rtl" style="font-size:.9rem;opacity:.8"></p>
  <script>
    fetch('./meta/progress.json').then(r=>r.json()).then(d=>{
      document.getElementById('last-updated').textContent =
        `×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”: ${new Date(d.timestamp||Date.now()).toLocaleString('he-IL')}`;
    }).catch(()=>{});
      // ×©×œ×™×¤×ª ×¡×”"×› ×ª×œ××™×“×™×
      fetch('./data/summary/counts.json').then(r=>r.json()).then(d=>{
        document.getElementById('totalCount').textContent = d.total || 'â€”';
        document.getElementById('count7').textContent = d.byGrade?.['7'] ?? 'â€”';
        document.getElementById('count8').textContent = d.byGrade?.['8'] ?? 'â€”';
        document.getElementById('count9').textContent = d.byGrade?.['9'] ?? 'â€”';
      }).catch(()=>{});
  </script>
  <script src="script.js" defer></script>
  <!-- HMR check: modified for live reload test -->
</body>
  <script>
  (function(){
    const isDev = location.hostname.endsWith("github.dev") || location.port === "5500";
    if ('serviceWorker' in navigator) {
      if (isDev) { navigator.serviceWorker.getRegistrations().then(rs=>rs.forEach(r=>r.unregister())); }
      else { window.addEventListener('load', ()=>navigator.serviceWorker.register('./service-worker.js').catch(console.error)); }
    }
  })();
  let deferredPrompt;
  const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);
  const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    document.getElementById('installBtn')?.removeAttribute('disabled');
  });
  window.addEventListener('load', () => {
    const installBtn = document.getElementById('installBtn');
    const iosHint = document.getElementById('iosHint');
    if (isStandalone) {
      if (installBtn) { installBtn.textContent = '××•×ª×§×Ÿ âœ”'; installBtn.disabled = true; }
      return;
    }
    if (isIOS) {
      if (iosHint) iosHint.hidden = false;
    }
    if (installBtn) {
      if (!deferredPrompt && !isIOS) installBtn.setAttribute('disabled','');
      installBtn.addEventListener('click', async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        deferredPrompt = null;
        if (outcome === 'accepted') {
          installBtn.textContent = '××•×ª×§×Ÿ âœ”';
          installBtn.disabled = true;
        }
      });
    }
  });
  </script>
</html>
